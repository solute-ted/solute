<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solute | Detail</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500&family=Playfair+Display:ital,wght@0,600;1,600&display=swap');

        :root {
            --bg-color: #fcfcfc;
            --primary-dark: #1a1a1a;
            --text-muted: #888;
            --accent-green: #4a5d4e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg-color);
            font-family: 'Noto Sans KR', sans-serif;
            color: var(--primary-dark);
            overflow-x: hidden;
        }

        /* ─── 로딩 오버레이 ─── */


        /* ─── 헤더 ─── */
        header {
            position: fixed; top: 0; width: 100%;
            display: flex; justify-content: space-between; align-items: center;
            padding: 40px 60px; z-index: 10000;
            background-color: var(--bg-color);
            transform: translateZ(0);
        }
        header nav:first-of-type { position: absolute; left: 50%; transform: translateX(-50%); }
        .logo {
            font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 600;
            letter-spacing: 1px; text-decoration: none; color: var(--primary-dark);
        }
        nav { display: flex; align-items: center; position: relative; }
        nav a {
            text-decoration: none; color: var(--primary-dark);
            margin-left: 20px; font-size: 0.85rem;
            letter-spacing: 0px; font-weight: 400;
        }

        /* ─── 햄버거 버튼 ─── */
        .hamburger {
            display: none;
            flex-direction: column;
            justify-content: center;
            gap: 5px;
            cursor: pointer;
            margin-left: 20px;
            padding: 4px;
        }
        .hamburger span {
            display: block;
            width: 22px; height: 1.5px;
            background-color: var(--primary-dark);
            transition: all 0.3s ease;
        }
        .hamburger.open span:nth-child(1) { transform: translateY(6.5px) rotate(45deg); }
        .hamburger.open span:nth-child(2) { opacity: 0; }
        .hamburger.open span:nth-child(3) { transform: translateY(-6.5px) rotate(-45deg); }

        /* ─── 모바일 메뉴 ─── */
        .mobile-menu {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: var(--bg-color);
            z-index: 9999;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-end;
            padding-top: 100px;
            padding-right: 25px;
            gap: 30px;
            opacity: 0; visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        .mobile-menu.open { opacity: 1; visibility: visible; }
        .mobile-menu a {
            text-decoration: none;
            color: var(--primary-dark);
            font-size: 0.85rem;
            letter-spacing: 0px;
            font-weight: 400;
            font-family: 'Noto Sans KR', sans-serif;
        }

        /* ─── 미니카트 ─── */
        .mini-cart {
            position: absolute; top: 20px; right: 0; width: 280px;
            background: #fff; border: 1px solid #eee;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            padding: 20px; z-index: 10001;
            opacity: 0; visibility: hidden; transform: translateY(10px);
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            text-align: left;
        }
        .mini-cart.active { opacity: 1; visibility: visible; transform: translateY(0); }
        .mini-cart-header { font-size: 0.7rem; letter-spacing: 1px; color: #aaa; margin-bottom: 15px; border-bottom: 1px solid #f5f5f5; padding-bottom: 10px; text-transform: uppercase; }
        .mini-item { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .mini-img { width: 50px; height: 50px; background: #eee; border-radius: 2px; flex-shrink: 0; background-size: contain; background-position: center; background-repeat: no-repeat; }
        .mini-info h4 { font-size: 0.85rem; margin-bottom: 2px; font-weight: 500; }
        .mini-info p { font-size: 0.75rem; color: #888; }
        .go-cart-btn {
            display: block; width: 100%; padding: 12px;
            background: var(--primary-dark); color: #fff !important;
            text-align: center; font-size: 0.75rem; text-decoration: none;
            letter-spacing: 1px; margin-top: 10px; margin-left: 0 !important;
        }
        .go-cart-btn:hover { background: #333; }

        /* ─── 상세 레이아웃 ─── */
        .detail-wrapper { 
            display: flex; padding: 180px 10% 80px; gap: 80px; 
            max-width: 1400px; margin: 0 auto; align-items: flex-start;
        }

        #mainImg {
            flex: 1;
            width: 100%;
            min-width: 0;
            aspect-ratio: 1 / 1;
            background-color: transparent !important;
            background-size: 300% !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            filter: 
                drop-shadow(10px 20px 10px rgba(0,0,0,0.15))
                drop-shadow(30px 60px 40px rgba(0,0,0,0.1))
                drop-shadow(60px 100px 80px rgba(0,0,0,0.05)) !important;
            opacity: 1;
            transition: none;
            mix-blend-mode: multiply;
            mask-image: radial-gradient(circle, black 70%, rgba(0,0,0,0) 100%);
            -webkit-mask-image: radial-gradient(circle, black 70%, rgba(0,0,0,0) 100%);
            will-change: transform, opacity;
        }
        #mainImg.loaded { opacity: 1; }

        @media (min-width: 769px) {
            #mainImg { min-width: 500px; }
        }

        .detail-info { flex: 1; position: sticky; top: 180px; }

        #productCode { font-size: 0.8rem; letter-spacing: 2px; color: #aaa; margin-bottom: 15px; display: block; }
        #productName { font-family: 'Playfair Display', serif; font-size: 3.5rem; margin-bottom: 15px; line-height: 1.1; }
        #productPrice { font-size: 1.5rem; color: var(--accent-green); margin-bottom: 40px; font-weight: 500; }
        .desc { line-height: 1.8; color: #666; margin-bottom: 50px; font-weight: 300; font-size: 0.95rem; }
        
        .buy-btn { 
            display: block; width: 100%; padding: 22px; 
            background: var(--primary-dark); color: #fff; 
            text-align: center; text-decoration: none; 
            letter-spacing: 2px; font-size: 0.9rem;
            transition: opacity 0.3s; cursor: pointer; border: none;
        }
        .buy-btn:hover { opacity: 0.9; }



        /* ─── 반응형 ─── */
        @media (max-width: 768px) {
            header { padding: 30px 25px; }
            header nav:first-of-type { display: none; }
            .hamburger { display: flex; }
            .mobile-menu { display: flex; }
            .desktop-only { display: none; }
            nav a { margin-left: 20px; }
            .mini-cart { width: 250px; right: -10px; }
            .detail-wrapper { flex-direction: column; padding: 120px 25px 60px; gap: 40px; }
            .detail-info { position: static; }
            #productName { font-size: 2.5rem; }
            #mainImg {
                min-width: unset;
                background-size: 160% !important;
            }
        }
    </style>
</head>
<body>


<!-- 모바일 메뉴 -->
<div class="mobile-menu" id="mobile-menu">
    <a href="./shop.html">Shop</a>
    <a href="#">How to Build</a>
    <a href="#">Login</a>
    <a href="#">About</a>
</div>

<header>
    <a href="./index.html" class="logo">Solute</a>
    <nav>
        <a href="./shop.html">SHOP</a>
        <a href="#">HOW TO BUILD</a>
    </nav>
    <nav>
        <a href="#" class="desktop-only">ACCOUNT</a>
        <a href="./cart.html" id="cart-link">CART<span id="cart-count"></span></a>
        <div id="mini-cart" class="mini-cart">
            <div class="mini-cart-header">RECENTLY ADDED</div>
            <div id="mini-cart-list"></div>
            <a href="./cart.html" class="go-cart-btn">VIEW ALL CART</a>
        </div>
        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>
</header>

<main class="detail-wrapper">
    <div id="mainImg" class="detail-img"></div>
    <div class="detail-info">
        <span id="productCode">ITEM CODE</span>
        <h1 id="productName">Loading...</h1>
        <p id="productPrice">₩0</p>
        <div class="desc">
            Solute의 모듈러 가구 시리즈는 공간의 목적에 따라 자유롭게 확장 가능합니다. <br><br>
            재생 아크릴과 지속 가능한 목재를 사용하여 환경과 디자인을 동시에 고려했습니다.
        </div>
        <button class="buy-btn" onclick="addToCart()">ADD TO CART</button>
    </div>
</main>

<script>
    const products = {
        "ab1": { name: "Acrylic Base",  price: "₩159,000", color: "#f5f5f5",  code: "AB1", img: "./assets/images/acrylic_base.png" },
        "al1": { name: "Acrylic Layer", price: "₩139,000", color: "#e8eef2",  code: "AL1", img: "./assets/images/acrylic_layer.png" },
        "wb1": { name: "Wood Base",     price: "₩149,000", color: "#f2e9e1",  code: "WB1", img: "./assets/images/wood_base.png" },
        "wl1": { name: "Wood Layer",    price: "₩129,000", color: "#ece0d1",  code: "WL1", img: "./assets/images/wood_layer.png" }
    };

    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    let currentProduct = null;
    let miniCartTimer;

    if (id && products[id]) {
        currentProduct = products[id];
        document.getElementById('productCode').innerText = currentProduct.code;
        document.getElementById('productName').innerText = currentProduct.name;
        document.getElementById('productPrice').innerText = currentProduct.price;
        document.title = `Solute | ${currentProduct.name}`;

        const mainImgElem = document.getElementById('mainImg');
        mainImgElem.style.backgroundImage = `url('${currentProduct.img}')`;
        mainImgElem.classList.add('loaded');
    }

    function updateCartStatus() {
        const cart = JSON.parse(localStorage.getItem('solute_cart')) || [];
        const totalCount = cart.reduce((sum, item) => sum + item.quantity, 0);
        const countEl = document.getElementById('cart-count');
        if (countEl) countEl.innerText = totalCount > 0 ? `(${totalCount})` : '';
        const listEl = document.getElementById('mini-cart-list');
        if (listEl) {
            if (cart.length > 0) {
                listEl.innerHTML = [...cart].reverse().slice(0, 3).map(item => `
                    <div class="mini-item">
                        <div class="mini-img" style="background-color:${item.color}; background-image:url('${item.img||''}')"></div>
                        <div class="mini-info">
                            <h4>${item.name}</h4>
                            <p>${item.price} (Qty:${item.quantity})</p>
                        </div>
                    </div>`).join('');
            } else {
                listEl.innerHTML = '<p style="font-size:0.75rem;color:#ccc;margin-bottom:15px;">장바구니가 비어있습니다.</p>';
            }
        }
    }

    function initCartHoverEvents() {
        const cartLink = document.getElementById('cart-link');
        const miniCart = document.getElementById('mini-cart');
        if (!cartLink || !miniCart) return;
        cartLink.addEventListener('mouseenter', () => { clearTimeout(miniCartTimer); updateCartStatus(); miniCart.classList.add('active'); });
        cartLink.addEventListener('mouseleave', () => { miniCartTimer = setTimeout(() => miniCart.classList.remove('active'), 500); });
        miniCart.addEventListener('mouseenter', () => clearTimeout(miniCartTimer));
        miniCart.addEventListener('mouseleave', () => { miniCartTimer = setTimeout(() => miniCart.classList.remove('active'), 500); });
    }

    /* ─── 햄버거 메뉴 ─── */
    const hamburger = document.getElementById('hamburger');
    const mobileMenu = document.getElementById('mobile-menu');

    hamburger.addEventListener('click', () => {
        hamburger.classList.toggle('open');
        mobileMenu.classList.toggle('open');
        document.body.style.overflow = mobileMenu.classList.contains('open') ? 'hidden' : '';
    });

    mobileMenu.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
            hamburger.classList.remove('open');
            mobileMenu.classList.remove('open');
            document.body.style.overflow = '';
        });
    });

    function addToCart() {
        if (!currentProduct) return;
        let cart = JSON.parse(localStorage.getItem('solute_cart')) || [];
        const existingIndex = cart.findIndex(item => item.id === id);
        if (existingIndex > -1) { cart[existingIndex].quantity += 1; }
        else { cart.push({ id, name: currentProduct.name, price: currentProduct.price, code: currentProduct.code, color: currentProduct.color, img: currentProduct.img || '', quantity: 1 }); }
        localStorage.setItem('solute_cart', JSON.stringify(cart));
        updateCartStatus();

        const miniCart = document.getElementById('mini-cart');
        miniCart.classList.add('active');
        clearTimeout(miniCartTimer);
        miniCartTimer = setTimeout(() => {
            if (!miniCart.matches(':hover') && !document.getElementById('cart-link').matches(':hover')) {
                miniCart.classList.remove('active');
            }
        }, 3000);
    }

    window.addEventListener('load', () => {
        updateCartStatus();
        initCartHoverEvents();

    });

    window.addEventListener('pageshow', updateCartStatus);
</script>
</body>
</html>